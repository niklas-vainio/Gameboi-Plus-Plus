/**
 * CPU instruction implementations.
 *
 * File skeleton generated by scripts/generate_instruction_code.py
 *
 * @author Niklas Vainio
 * @date   2026-02-01
 */

#include "common/logging.hpp"
#include <format>

namespace Gbpp::Backend
{

template <typename Bus>
void Cpu<Bus>::instruction_ILLEGAL()
{
    /*
     * Catch-all for illegal opcodes. Log an error and do nothing.
     */
    LogError("Encoutered invalid opcode 0x%02X at PC = 0x%04X", opcode, pc - 1);
    current_instruction_asm = std::format("ILLEGAL {:02X}", opcode);
}

/*
 * ============================================================================
 * Unprefixed Instructions
 * ============================================================================
 */

template <typename Bus>
void Cpu<Bus>::instruction_00_NOP()
{
    /*
     * NOP
     * Flags: - - - -
     * Cycles: 4
     */
    current_instruction_asm = std::format("NOP");
}

template <typename Bus>
void Cpu<Bus>::instruction_01_LD()
{
    /*
     * LD BC, n16
     * Flags: - - - -
     * Cycles: 12
     */
    const uint16_t n16 = fetch_16();
    set_BC(n16);

    current_instruction_asm = std::format("LD BC, {:04X}", n16);
}

template <typename Bus>
void Cpu<Bus>::instruction_02_LD()
{
    /*
     * LD [BC], A
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_BC(), A);

    current_instruction_asm = std::format("LD !BC, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_03_INC()
{
    /*
     * INC BC
     * Flags: - - - -
     * Cycles: 8
     */
    set_BC(get_BC() + 1);

    current_instruction_asm = std::format("INC BC");
}

template <typename Bus>
void Cpu<Bus>::instruction_04_INC()
{
    /*
     * INC B
     * Flags: Z 0 H -
     * Cycles: 4
     */
    B++;

    set_Z(B == 0);
    set_N(0);
    set_H((B & 0x0f) == 0);
    current_instruction_asm = std::format("INC B");
}

template <typename Bus>
void Cpu<Bus>::instruction_05_DEC()
{
    /*
     * DEC B
     * Flags: Z 1 H -
     * Cycles: 4
     */
    B--;

    set_Z(B == 0);
    set_N(1);
    set_H((B & 0x0f) == 0xf);
    current_instruction_asm = std::format("DEC B");
}

template <typename Bus>
void Cpu<Bus>::instruction_06_LD()
{
    /*
     * LD B, n8
     * Flags: - - - -
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    B = n8;

    current_instruction_asm = std::format("LD B, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_07_RLCA()
{
    /*
     * RLCA
     * Flags: 0 0 0 C
     * Cycles: 4
     */
    const bool bit_7 = A >> 7;
    A = (A << 1) | bit_7;

    set_Z(0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLCA");
}

template <typename Bus>
void Cpu<Bus>::instruction_08_LD()
{
    /*
     * LD [a16], SP
     * Flags: - - - -
     * Cycles: 20
     */
    const uint16_t a16 = fetch_16();
    write_16(a16, sp);

    current_instruction_asm = std::format("LD !{:04X}, SP", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_09_ADD()
{
    /*
     * ADD HL, BC
     * Flags: - 0 H C
     * Cycles: 8
     */
    const uint16_t op1 = get_HL();
    const uint16_t op2 = get_BC();
    const uint32_t sum = op1 + op2;

    set_HL(sum);

    set_N(0);
    set_H((op1 & 0x0fff) + (op2 & 0x0fff) > 0x0fff);
    set_C(sum & 0x10000);
    current_instruction_asm = std::format("ADD HL, BC");
}

template <typename Bus>
void Cpu<Bus>::instruction_0A_LD()
{
    /*
     * LD A, [BC]
     * Flags: - - - -
     * Cycles: 8
     */
    A = read_8(get_BC());

    current_instruction_asm = std::format("LD A, !BC");
}

template <typename Bus>
void Cpu<Bus>::instruction_0B_DEC()
{
    /*
     * DEC BC
     * Flags: - - - -
     * Cycles: 8
     */
    set_BC(get_BC() - 1);

    current_instruction_asm = std::format("DEC BC");
}

template <typename Bus>
void Cpu<Bus>::instruction_0C_INC()
{
    /*
     * INC C
     * Flags: Z 0 H -
     * Cycles: 4
     */
    C++;

    set_Z(C == 0);
    set_N(0);
    set_H((C & 0x0f) == 0);
    current_instruction_asm = std::format("INC C");
}

template <typename Bus>
void Cpu<Bus>::instruction_0D_DEC()
{
    /*
     * DEC C
     * Flags: Z 1 H -
     * Cycles: 4
     */
    C--;

    set_Z(C == 0);
    set_N(1);
    set_H((C & 0x0f) == 0xf);
    current_instruction_asm = std::format("DEC C");
}

template <typename Bus>
void Cpu<Bus>::instruction_0E_LD()
{
    /*
     * LD C, n8
     * Flags: - - - -
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    C = n8;

    current_instruction_asm = std::format("LD C, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_0F_RRCA()
{
    /*
     * RRCA
     * Flags: 0 0 0 C
     * Cycles: 4
     */
    bool bit_0 = A & 1;
    A = (bit_0 << 7) | (A >> 1);

    set_Z(0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRCA");
}

template <typename Bus>
void Cpu<Bus>::instruction_10_STOP()
{
    /*
     * FIXME - handle this properly
     * STOP n8
     * Flags: - - - -
     * Cycles: 4
     */
    LogWarning("STOP is not fully implemented!");
    const uint8_t n8 = fetch_8();
    stopped = true;

    current_instruction_asm = std::format("STOP {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_11_LD()
{
    /*
     * LD DE, n16
     * Flags: - - - -
     * Cycles: 12
     */
    const uint16_t n16 = fetch_16();
    set_DE(n16);

    current_instruction_asm = std::format("LD DE, {:04X}", n16);
}

template <typename Bus>
void Cpu<Bus>::instruction_12_LD()
{
    /*
     * LD [DE], A
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_DE(), A);

    current_instruction_asm = std::format("LD !DE, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_13_INC()
{
    /*
     * INC DE
     * Flags: - - - -
     * Cycles: 8
     */
    set_DE(get_DE() + 1);

    current_instruction_asm = std::format("INC DE");
}

template <typename Bus>
void Cpu<Bus>::instruction_14_INC()
{
    /*
     * INC D
     * Flags: Z 0 H -
     * Cycles: 4
     */
    D++;

    set_Z(D == 0);
    set_N(0);
    set_H((D & 0x0f) == 0);
    current_instruction_asm = std::format("INC D");
}

template <typename Bus>
void Cpu<Bus>::instruction_15_DEC()
{
    /*
     * DEC D
     * Flags: Z 1 H -
     * Cycles: 4
     */
    D--;

    set_Z(D == 0);
    set_N(1);
    set_H((D & 0x0f) == 0xf);
    current_instruction_asm = std::format("DEC D");
}

template <typename Bus>
void Cpu<Bus>::instruction_16_LD()
{
    /*
     * LD D, n8
     * Flags: - - - -
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    D = n8;

    current_instruction_asm = std::format("LD D, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_17_RLA()
{
    /*
     * RLA
     * Flags: 0 0 0 C
     * Cycles: 4
     */
    const bool bit_7 = A >> 7;
    A = (A << 1) | get_C();

    set_Z(0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLA ");
}

template <typename Bus>
void Cpu<Bus>::instruction_18_JR()
{
    /*
     * JR e8
     * Flags: - - - -
     * Cycles: 12
     */
    const int8_t e8 = static_cast<int8_t>(fetch_8());
    pc += e8;

    current_instruction_asm = std::format("JR {:04X}", pc);
}

template <typename Bus>
void Cpu<Bus>::instruction_19_ADD()
{
    /*
     * ADD HL, DE
     * Flags: - 0 H C
     * Cycles: 8
     */
    const uint16_t op1 = get_HL();
    const uint16_t op2 = get_DE();
    const uint32_t sum = op1 + op2;

    set_HL(sum);

    set_N(0);
    set_H((op1 & 0x0fff) + (op2 & 0x0fff) > 0x0fff);
    set_C(sum & 0x10000);
    current_instruction_asm = std::format("ADD HL, DE");
}

template <typename Bus>
void Cpu<Bus>::instruction_1A_LD()
{
    /*
     * LD A, [DE]
     * Flags: - - - -
     * Cycles: 8
     */
    A = read_8(get_DE());

    current_instruction_asm = std::format("LD A, !DE");
}

template <typename Bus>
void Cpu<Bus>::instruction_1B_DEC()
{
    /*
     * DEC DE
     * Flags: - - - -
     * Cycles: 8
     */
    set_DE(get_DE() - 1);

    current_instruction_asm = std::format("DEC DE");
}

template <typename Bus>
void Cpu<Bus>::instruction_1C_INC()
{
    /*
     * INC E
     * Flags: Z 0 H -
     * Cycles: 4
     */
    E++;

    set_Z(E == 0);
    set_N(0);
    set_H((E & 0x0f) == 0);
    current_instruction_asm = std::format("INC E");
}

template <typename Bus>
void Cpu<Bus>::instruction_1D_DEC()
{
    /*
     * DEC E
     * Flags: Z 1 H -
     * Cycles: 4
     */
    E--;

    set_Z(E == 0);
    set_N(1);
    set_H((E & 0x0f) == 0xf);
    current_instruction_asm = std::format("DEC E");
}

template <typename Bus>
void Cpu<Bus>::instruction_1E_LD()
{
    /*
     * LD E, n8
     * Flags: - - - -
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    E = n8;

    current_instruction_asm = std::format("LD E, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_1F_RRA()
{
    /*
     * RRA
     * Flags: 0 0 0 C
     * Cycles: 4
     */
    bool bit_0 = A & 1;
    A = (get_C() << 7) | (A >> 1);

    set_Z(0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRA ");
}

template <typename Bus>
void Cpu<Bus>::instruction_20_JR()
{
    /*
     * JR NZ, e8
     * Flags: - - - -
     * Cycles: 8
     */
    const int8_t e8 = static_cast<int8_t>(fetch_8());
    const uint16_t dest = pc + e8;

    if (!get_Z())
    {
        pc = dest;
        num_cycles_elapsed += 4;
    }

    current_instruction_asm = std::format("JR NZ, {:04X}", dest);
}

template <typename Bus>
void Cpu<Bus>::instruction_21_LD()
{
    /*
     * LD HL, n16
     * Flags: - - - -
     * Cycles: 12
     */
    const uint16_t n16 = fetch_16();
    set_HL(n16);

    current_instruction_asm = std::format("LD HL, {:04X}", n16);
}

template <typename Bus>
void Cpu<Bus>::instruction_22_LD()
{
    /*
     * LD [HL+], A
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), A);
    set_HL(get_HL() + 1);

    current_instruction_asm = std::format("LDI !HL, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_23_INC()
{
    /*
     * INC HL
     * Flags: - - - -
     * Cycles: 8
     */
    set_HL(get_HL() + 1);

    current_instruction_asm = std::format("INC HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_24_INC()
{
    /*
     * INC H
     * Flags: Z 0 H -
     * Cycles: 4
     */
    H++;

    set_Z(H == 0);
    set_N(0);
    set_H((H & 0x0f) == 0);
    current_instruction_asm = std::format("INC H");
}

template <typename Bus>
void Cpu<Bus>::instruction_25_DEC()
{
    /*
     * DEC H
     * Flags: Z 1 H -
     * Cycles: 4
     */
    H--;

    set_Z(H == 0);
    set_N(1);
    set_H((H & 0x0f) == 0xf);
    current_instruction_asm = std::format("DEC H");
}

template <typename Bus>
void Cpu<Bus>::instruction_26_LD()
{
    /*
     * LD H, n8
     * Flags: - - - -
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    H = n8;

    current_instruction_asm = std::format("LD H, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_27_DAA()
{
    /*
     * DAA
     * Flags: Z - 0 C
     * Cycles: 4
     */
    if (get_N())
    {
        uint8_t adjustment = 0;
        adjustment += get_H() ? 0x6 : 0;
        adjustment += get_C() ? 0x60 : 0;
        A -= adjustment;
    }
    else
    {
        uint8_t adjustment = 0;
        adjustment += (get_H() || (A & 0x0f) > 0x09) ? 0x6 : 0;
        adjustment += (get_C() || A > 0x99) ? 0x60 : 0;
        set_C(get_C() || A > 0x99);

        A += adjustment;
    }

    set_Z(A == 0);
    set_H(0);
    current_instruction_asm = std::format("DAA");
}

template <typename Bus>
void Cpu<Bus>::instruction_28_JR()
{
    /*
     * JR Z, e8
     * Flags: - - - -
     * Cycles: 8/12
     */
    const int8_t e8 = static_cast<int8_t>(fetch_8());
    const uint16_t dest = pc + e8;

    if (get_Z())
    {
        pc = dest;
        num_cycles_elapsed += 4;
    }

    current_instruction_asm = std::format("JR Z, {:04X}", dest);
}

template <typename Bus>
void Cpu<Bus>::instruction_29_ADD()
{
    /*
     * ADD HL, HL
     * Flags: - 0 H C
     * Cycles: 8
     */
    const uint16_t op1 = get_HL();
    const uint16_t op2 = get_HL();
    const uint32_t sum = op1 + op2;

    set_HL(sum);

    set_N(0);
    set_H((op1 & 0x0fff) + (op2 & 0x0fff) > 0x0fff);
    set_C(sum & 0x10000);
    current_instruction_asm = std::format("ADD HL, HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_2A_LD()
{
    /*
     * LD A, [HL+]
     * Flags: - - - -
     * Cycles: 8
     */
    A = read_8(get_HL());
    set_HL(get_HL() + 1);

    current_instruction_asm = std::format("LDI A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_2B_DEC()
{
    /*
     * DEC HL
     * Flags: - - - -
     * Cycles: 8
     */
    set_HL(get_HL() - 1);

    current_instruction_asm = std::format("DEC HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_2C_INC()
{
    /*
     * INC L
     * Flags: Z 0 H -
     * Cycles: 4
     */
    L++;

    set_Z(L == 0);
    set_N(0);
    set_H((L & 0x0f) == 0);
    current_instruction_asm = std::format("INC L");
}

template <typename Bus>
void Cpu<Bus>::instruction_2D_DEC()
{
    /*
     * DEC L
     * Flags: Z 1 H -
     * Cycles: 4
     */
    L--;

    set_Z(L == 0);
    set_N(1);
    set_H((L & 0x0f) == 0xf);
    current_instruction_asm = std::format("DEC L");
}

template <typename Bus>
void Cpu<Bus>::instruction_2E_LD()
{
    /*
     * LD L, n8
     * Flags: - - - -
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    L = n8;

    current_instruction_asm = std::format("LD L, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_2F_CPL()
{
    /*
     * CPL
     * Flags: - 1 1 -
     * Cycles: 4
     */
    A = ~A;

    set_N(1);
    set_H(1);
    current_instruction_asm = std::format("CPL ");
}

template <typename Bus>
void Cpu<Bus>::instruction_30_JR()
{
    /*
     * JR NC, e8
     * Flags: - - - -
     * Cycles: 8
     */
    const int8_t e8 = static_cast<int8_t>(fetch_8());
    const uint16_t dest = pc + e8;

    if (!get_C())
    {
        pc = dest;
        num_cycles_elapsed += 4;
    }

    current_instruction_asm = std::format("JR NC, {:04X}", dest);
}

template <typename Bus>
void Cpu<Bus>::instruction_31_LD()
{
    /*
     * LD SP, n16
     * Flags: - - - -
     * Cycles: 12
     */
    const uint16_t n16 = fetch_16();
    sp = n16;

    current_instruction_asm = std::format("LD SP, {:04X}", n16);
}

template <typename Bus>
void Cpu<Bus>::instruction_32_LD()
{
    /*
     * LD [HL-], A
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), A);
    set_HL(get_HL() - 1);

    current_instruction_asm = std::format("LDD !HL, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_33_INC()
{
    /*
     * INC SP
     * Flags: - - - -
     * Cycles: 8
     */
    sp++;

    current_instruction_asm = std::format("INC SP");
}

template <typename Bus>
void Cpu<Bus>::instruction_34_INC()
{
    /*
     * INC [HL]
     * Flags: Z 0 H -
     * Cycles: 12
     */
    const uint8_t result = read_8(get_HL()) + 1;
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(0);
    set_H((result & 0x0f) == 0);
    current_instruction_asm = std::format("INC !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_35_DEC()
{
    /*
     * DEC [HL]
     * Flags: Z 1 H -
     * Cycles: 12
     */
    const uint8_t result = read_8(get_HL()) - 1;
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(1);
    set_H((result & 0x0f) == 0xf);
    current_instruction_asm = std::format("DEC !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_36_LD()
{
    /*
     * LD [HL], n8
     * Flags: - - - -
     * Cycles: 12
     */
    const uint8_t n8 = fetch_8();
    write_8(get_HL(), n8);

    current_instruction_asm = std::format("LD !HL, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_37_SCF()
{
    /*
     * SCF
     * Flags: - 0 0 1
     * Cycles: 4
     */
    set_N(0);
    set_H(0);
    set_C(1);
    current_instruction_asm = std::format("SCF ");
}

template <typename Bus>
void Cpu<Bus>::instruction_38_JR()
{
    /*
     * JR C, e8
     * Flags: - - - -
     * Cycles: 8
     */
    const int8_t e8 = static_cast<int8_t>(fetch_8());
    const uint16_t dest = pc + e8;

    if (get_C())
    {
        pc = dest;
        num_cycles_elapsed += 4;
    }

    current_instruction_asm = std::format("JR C, {:04X}", dest);
}

template <typename Bus>
void Cpu<Bus>::instruction_39_ADD()
{
    /*
     * ADD HL, SP
     * Flags: - 0 H C
     * Cycles: 8
     */
    const uint16_t op1 = get_HL();
    const uint16_t op2 = sp;
    const uint32_t sum = op1 + op2;

    set_HL(sum);

    set_N(0);
    set_H((op1 & 0x0fff) + (op2 & 0x0fff) > 0x0fff);
    set_C(sum & 0x10000);
    current_instruction_asm = std::format("ADD HL, SP");
}

template <typename Bus>
void Cpu<Bus>::instruction_3A_LD()
{
    /*
     * LD A, [HL-]
     * Flags: - - - -
     * Cycles: 8
     */
    A = read_8(get_HL());
    set_HL(get_HL() - 1);

    current_instruction_asm = std::format("LDD A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_3B_DEC()
{
    /*
     * DEC SP
     * Flags: - - - -
     * Cycles: 8
     */
    sp--;

    current_instruction_asm = std::format("DEC SP");
}

template <typename Bus>
void Cpu<Bus>::instruction_3C_INC()
{
    /*
     * INC A
     * Flags: Z 0 H -
     * Cycles: 4
     */
    A++;

    set_Z(A == 0);
    set_N(0);
    set_H((A & 0x0f) == 0);
    current_instruction_asm = std::format("INC A");
}

template <typename Bus>
void Cpu<Bus>::instruction_3D_DEC()
{
    /*
     * DEC A
     * Flags: Z 1 H -
     * Cycles: 4
     */
    A--;

    set_Z(A == 0);
    set_N(1);
    set_H((A & 0x0f) == 0xf);
    current_instruction_asm = std::format("DEC A");
}

template <typename Bus>
void Cpu<Bus>::instruction_3E_LD()
{
    /*
     * LD A, n8
     * Flags: - - - -
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    A = n8;

    current_instruction_asm = std::format("LD A, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_3F_CCF()
{
    /*
     * CCF
     * Flags: - 0 0 C
     * Cycles: 4
     */
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("CCF ");
}

template <typename Bus>
void Cpu<Bus>::instruction_40_LD()
{
    /*
     * LD B, B
     * Flags: - - - -
     * Cycles: 4
     */
    current_instruction_asm = std::format("LD B, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_41_LD()
{
    /*
     * LD B, C
     * Flags: - - - -
     * Cycles: 4
     */
    B = C;
    current_instruction_asm = std::format("LD B, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_42_LD()
{
    /*
     * LD B, D
     * Flags: - - - -
     * Cycles: 4
     */
    B = D;
    current_instruction_asm = std::format("LD B, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_43_LD()
{
    /*
     * LD B, E
     * Flags: - - - -
     * Cycles: 4
     */
    B = E;
    current_instruction_asm = std::format("LD B, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_44_LD()
{
    /*
     * LD B, H
     * Flags: - - - -
     * Cycles: 4
     */
    B = H;
    current_instruction_asm = std::format("LD B, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_45_LD()
{
    /*
     * LD B, L
     * Flags: - - - -
     * Cycles: 4
     */
    B = L;
    current_instruction_asm = std::format("LD B, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_46_LD()
{
    /*
     * LD B, [HL]
     * Flags: - - - -
     * Cycles: 8
     */
    B = read_8(get_HL());
    current_instruction_asm = std::format("LD B, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_47_LD()
{
    /*
     * LD B, A
     * Flags: - - - -
     * Cycles: 4
     */
    B = A;
    current_instruction_asm = std::format("LD B, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_48_LD()
{
    /*
     * LD C, B
     * Flags: - - - -
     * Cycles: 4
     */
    C = B;
    current_instruction_asm = std::format("LD C, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_49_LD()
{
    /*
     * LD C, C
     * Flags: - - - -
     * Cycles: 4
     */
    current_instruction_asm = std::format("LD C, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_4A_LD()
{
    /*
     * LD C, D
     * Flags: - - - -
     * Cycles: 4
     */
    C = D;
    current_instruction_asm = std::format("LD C, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_4B_LD()
{
    /*
     * LD C, E
     * Flags: - - - -
     * Cycles: 4
     */
    C = E;
    current_instruction_asm = std::format("LD C, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_4C_LD()
{
    /*
     * LD C, H
     * Flags: - - - -
     * Cycles: 4
     */
    C = H;
    current_instruction_asm = std::format("LD C, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_4D_LD()
{
    /*
     * LD C, L
     * Flags: - - - -
     * Cycles: 4
     */
    C = L;
    current_instruction_asm = std::format("LD C, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_4E_LD()
{
    /*
     * LD C, [HL]
     * Flags: - - - -
     * Cycles: 8
     */
    C = read_8(get_HL());
    current_instruction_asm = std::format("LD C, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_4F_LD()
{
    /*
     * LD C, A
     * Flags: - - - -
     * Cycles: 4
     */
    C = A;
    current_instruction_asm = std::format("LD C, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_50_LD()
{
    /*
     * LD D, B
     * Flags: - - - -
     * Cycles: 4
     */
    D = B;
    current_instruction_asm = std::format("LD D, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_51_LD()
{
    /*
     * LD D, C
     * Flags: - - - -
     * Cycles: 4
     */
    D = C;
    current_instruction_asm = std::format("LD D, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_52_LD()
{
    /*
     * LD D, D
     * Flags: - - - -
     * Cycles: 4
     */
    current_instruction_asm = std::format("LD D, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_53_LD()
{
    /*
     * LD D, E
     * Flags: - - - -
     * Cycles: 4
     */
    D = E;
    current_instruction_asm = std::format("LD D, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_54_LD()
{
    /*
     * LD D, H
     * Flags: - - - -
     * Cycles: 4
     */
    D = H;
    current_instruction_asm = std::format("LD D, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_55_LD()
{
    /*
     * LD D, L
     * Flags: - - - -
     * Cycles: 4
     */
    D = L;
    current_instruction_asm = std::format("LD D, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_56_LD()
{
    /*
     * LD D, [HL]
     * Flags: - - - -
     * Cycles: 8
     */
    D = read_8(get_HL());
    current_instruction_asm = std::format("LD D, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_57_LD()
{
    /*
     * LD D, A
     * Flags: - - - -
     * Cycles: 4
     */
    D = A;
    current_instruction_asm = std::format("LD D, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_58_LD()
{
    /*
     * LD E, B
     * Flags: - - - -
     * Cycles: 4
     */
    E = B;
    current_instruction_asm = std::format("LD E, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_59_LD()
{
    /*
     * LD E, C
     * Flags: - - - -
     * Cycles: 4
     */
    E = C;
    current_instruction_asm = std::format("LD E, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_5A_LD()
{
    /*
     * LD E, D
     * Flags: - - - -
     * Cycles: 4
     */
    E = D;
    current_instruction_asm = std::format("LD E, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_5B_LD()
{
    /*
     * LD E, E
     * Flags: - - - -
     * Cycles: 4
     */
    current_instruction_asm = std::format("LD E, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_5C_LD()
{
    /*
     * LD E, H
     * Flags: - - - -
     * Cycles: 4
     */
    E = H;
    current_instruction_asm = std::format("LD E, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_5D_LD()
{
    /*
     * LD E, L
     * Flags: - - - -
     * Cycles: 4
     */
    E = L;
    current_instruction_asm = std::format("LD E, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_5E_LD()
{
    /*
     * LD E, [HL]
     * Flags: - - - -
     * Cycles: 8
     */
    E = read_8(get_HL());
    current_instruction_asm = std::format("LD E, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_5F_LD()
{
    /*
     * LD E, A
     * Flags: - - - -
     * Cycles: 4
     */
    E = A;
    current_instruction_asm = std::format("LD E, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_60_LD()
{
    /*
     * LD H, B
     * Flags: - - - -
     * Cycles: 4
     */
    H = B;
    current_instruction_asm = std::format("LD H, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_61_LD()
{
    /*
     * LD H, C
     * Flags: - - - -
     * Cycles: 4
     */
    H = C;
    current_instruction_asm = std::format("LD H, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_62_LD()
{
    /*
     * LD H, D
     * Flags: - - - -
     * Cycles: 4
     */
    H = D;
    current_instruction_asm = std::format("LD H, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_63_LD()
{
    /*
     * LD H, E
     * Flags: - - - -
     * Cycles: 4
     */
    H = E;
    current_instruction_asm = std::format("LD H, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_64_LD()
{
    /*
     * LD H, H
     * Flags: - - - -
     * Cycles: 4
     */
    current_instruction_asm = std::format("LD H, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_65_LD()
{
    /*
     * LD H, L
     * Flags: - - - -
     * Cycles: 4
     */
    H = L;
    current_instruction_asm = std::format("LD H, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_66_LD()
{
    /*
     * LD H, [HL]
     * Flags: - - - -
     * Cycles: 8
     */
    H = read_8(get_HL());
    current_instruction_asm = std::format("LD H, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_67_LD()
{
    /*
     * LD H, A
     * Flags: - - - -
     * Cycles: 4
     */
    H = A;
    current_instruction_asm = std::format("LD H, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_68_LD()
{
    /*
     * LD L, B
     * Flags: - - - -
     * Cycles: 4
     */
    L = B;
    current_instruction_asm = std::format("LD L, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_69_LD()
{
    /*
     * LD L, C
     * Flags: - - - -
     * Cycles: 4
     */
    L = C;
    current_instruction_asm = std::format("LD L, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_6A_LD()
{
    /*
     * LD L, D
     * Flags: - - - -
     * Cycles: 4
     */
    L = D;
    current_instruction_asm = std::format("LD L, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_6B_LD()
{
    /*
     * LD L, E
     * Flags: - - - -
     * Cycles: 4
     */
    L = E;
    current_instruction_asm = std::format("LD L, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_6C_LD()
{
    /*
     * LD L, H
     * Flags: - - - -
     * Cycles: 4
     */
    L = H;
    current_instruction_asm = std::format("LD L, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_6D_LD()
{
    /*
     * LD L, L
     * Flags: - - - -
     * Cycles: 4
     */
    current_instruction_asm = std::format("LD L, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_6E_LD()
{
    /*
     * LD L, [HL]
     * Flags: - - - -
     * Cycles: 8
     */
    L = read_8(get_HL());
    current_instruction_asm = std::format("LD L, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_6F_LD()
{
    /*
     * LD L, A
     * Flags: - - - -
     * Cycles: 4
     */
    L = A;
    current_instruction_asm = std::format("LD L, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_70_LD()
{
    /*
     * LD [HL], B
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), B);
    current_instruction_asm = std::format("LD !HL, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_71_LD()
{
    /*
     * LD [HL], C
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), C);
    current_instruction_asm = std::format("LD !HL, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_72_LD()
{
    /*
     * LD [HL], D
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), D);
    current_instruction_asm = std::format("LD !HL, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_73_LD()
{
    /*
     * LD [HL], E
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), E);
    current_instruction_asm = std::format("LD !HL, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_74_LD()
{
    /*
     * LD [HL], H
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), H);
    current_instruction_asm = std::format("LD !HL, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_75_LD()
{
    /*
     * LD [HL], L
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), L);
    current_instruction_asm = std::format("LD !HL, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_76_HALT()
{
    /*
     * HALT
     * Flags: - - - -
     * Cycles: 4
     */
    LogDebug("Halting at pc = %04X", pc - 1);
    halted = true;
    current_instruction_asm = std::format("HALT");
}

template <typename Bus>
void Cpu<Bus>::instruction_77_LD()
{
    /*
     * LD [HL], A
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(get_HL(), A);
    current_instruction_asm = std::format("LD !HL, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_78_LD()
{
    /*
     * LD A, B
     * Flags: - - - -
     * Cycles: 4
     */
    A = B;
    current_instruction_asm = std::format("LD A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_79_LD()
{
    /*
     * LD A, C
     * Flags: - - - -
     * Cycles: 4
     */
    A = C;
    current_instruction_asm = std::format("LD A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_7A_LD()
{
    /*
     * LD A, D
     * Flags: - - - -
     * Cycles: 4
     */
    A = D;
    current_instruction_asm = std::format("LD A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_7B_LD()
{
    /*
     * LD A, E
     * Flags: - - - -
     * Cycles: 4
     */
    A = E;
    current_instruction_asm = std::format("LD A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_7C_LD()
{
    /*
     * LD A, H
     * Flags: - - - -
     * Cycles: 4
     */
    A = H;
    current_instruction_asm = std::format("LD A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_7D_LD()
{
    /*
     * LD A, L
     * Flags: - - - -
     * Cycles: 4
     */
    A = L;
    current_instruction_asm = std::format("LD A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_7E_LD()
{
    /*
     * LD A, [HL]
     * Flags: - - - -
     * Cycles: 8
     */
    A = read_8(get_HL());
    current_instruction_asm = std::format("LD A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_7F_LD()
{
    /*
     * LD A, A
     * Flags: - - - -
     * Cycles: 4
     */
    current_instruction_asm = std::format("LD A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_80_ADD()
{
    /*
     * ADD A, B
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = B;
    const uint16_t result = op1 + op2;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_81_ADD()
{
    /*
     * ADD A, C
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = C;
    const uint16_t result = op1 + op2;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_82_ADD()
{
    /*
     * ADD A, D
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = D;
    const uint16_t result = op1 + op2;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_83_ADD()
{
    /*
     * ADD A, E
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = E;
    const uint16_t result = op1 + op2;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_84_ADD()
{
    /*
     * ADD A, H
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = H;
    const uint16_t result = op1 + op2;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_85_ADD()
{
    /*
     * ADD A, L
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = L;
    const uint16_t result = op1 + op2;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_86_ADD()
{
    /*
     * ADD A, [HL]
     * Flags: Z 0 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t op2 = read_8(get_HL());
    const uint16_t result = op1 + op2;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_87_ADD()
{
    /*
     * ADD A, A
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = A;
    const uint16_t result = op1 + op2;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_88_ADC()
{
    /*
     * ADC A, B
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = B;
    const uint16_t result = op1 + op2 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_89_ADC()
{
    /*
     * ADC A, C
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = C;
    const uint16_t result = op1 + op2 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_8A_ADC()
{
    /*
     * ADC A, D
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = D;
    const uint16_t result = op1 + op2 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_8B_ADC()
{
    /*
     * ADC A, E
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = E;
    const uint16_t result = op1 + op2 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_8C_ADC()
{
    /*
     * ADC A, H
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = H;
    const uint16_t result = op1 + op2 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_8D_ADC()
{
    /*
     * ADC A, L
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = L;
    const uint16_t result = op1 + op2 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_8E_ADC()
{
    /*
     * ADC A, [HL]
     * Flags: Z 0 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t op2 = read_8(get_HL());
    const uint16_t result = op1 + op2 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_8F_ADC()
{
    /*
     * ADC A, A
     * Flags: Z 0 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = A;
    const uint16_t result = op1 + op2 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (op2 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_90_SUB()
{
    /*
     * SUB A, B
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = B;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SUB A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_91_SUB()
{
    /*
     * SUB A, C
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = C;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SUB A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_92_SUB()
{
    /*
     * SUB A, D
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = D;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SUB A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_93_SUB()
{
    /*
     * SUB A, E
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = E;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SUB A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_94_SUB()
{
    /*
     * SUB A, H
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = H;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SUB A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_95_SUB()
{
    /*
     * SUB A, L
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = L;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SUB A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_96_SUB()
{
    /*
     * SUB A, [HL]
     * Flags: Z 1 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t op2 = read_8(get_HL());
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SUB A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_97_SUB()
{
    /*
     * SUB A, A
     * Flags: 1 1 0 0
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = A;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(1);
    set_N(1);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SUB A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_98_SBC()
{
    /*
     * SBC A, B
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = B;
    const uint16_t result = op1 - op2 - get_C();

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f) + get_C());
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SBC A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_99_SBC()
{
    /*
     * SBC A, C
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = C;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SBC A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_9A_SBC()
{
    /*
     * SBC A, D
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = D;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SBC A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_9B_SBC()
{
    /*
     * SBC A, E
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = E;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SBC A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_9C_SBC()
{
    /*
     * SBC A, H
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = H;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SBC A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_9D_SBC()
{
    /*
     * SBC A, L
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = L;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SBC A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_9E_SBC()
{
    /*
     * SBC A, [HL]
     * Flags: Z 1 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t op2 = read_8(get_HL());
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SBC A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_9F_SBC()
{
    /*
     * SBC A, A
     * Flags: Z 1 H -
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = A;
    const uint16_t result = op1 - op2;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    current_instruction_asm = std::format("SBC A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_A0_AND()
{
    /*
     * AND A, B
     * Flags: Z 0 1 0
     * Cycles: 4
     */
    A &= B;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_A1_AND()
{
    /*
     * AND A, C
     * Flags: Z 0 1 0
     * Cycles: 4
     */
    A &= C;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_A2_AND()
{
    /*
     * AND A, D
     * Flags: Z 0 1 0
     * Cycles: 4
     */
    A &= D;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_A3_AND()
{
    /*
     * AND A, E
     * Flags: Z 0 1 0
     * Cycles: 4
     */
    A &= E;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_A4_AND()
{
    /*
     * AND A, H
     * Flags: Z 0 1 0
     * Cycles: 4
     */
    A &= H;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_A5_AND()
{
    /*
     * AND A, L
     * Flags: Z 0 1 0
     * Cycles: 4
     */
    A &= L;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_A6_AND()
{
    /*
     * AND A, [HL]
     * Flags: Z 0 1 0
     * Cycles: 8
     */
    A &= read_8(get_HL());

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_A7_AND()
{
    /*
     * AND A, A
     * Flags: Z 0 1 0
     * Cycles: 4
     */
    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_A8_XOR()
{
    /*
     * XOR A, B
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A ^= B;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("XOR A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_A9_XOR()
{
    /*
     * XOR A, C
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A ^= C;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("XOR A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_AA_XOR()
{
    /*
     * XOR A, D
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A ^= D;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("XOR A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_AB_XOR()
{
    /*
     * XOR A, E
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A ^= E;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("XOR A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_AC_XOR()
{
    /*
     * XOR A, H
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A ^= H;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("XOR A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_AD_XOR()
{
    /*
     * XOR A, L
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A ^= L;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("XOR A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_AE_XOR()
{
    /*
     * XOR A, [HL]
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    A ^= read_8(get_HL());

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("XOR A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_AF_XOR()
{
    /*
     * XOR A, A
     * Flags: 1 0 0 0
     * Cycles: 4
     */
    A = 0x00;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("XOR A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_B0_OR()
{
    /*
     * OR A, B
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A |= B;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("OR A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_B1_OR()
{
    /*
     * OR A, C
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A |= C;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("OR A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_B2_OR()
{
    /*
     * OR A, D
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A |= D;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("OR A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_B3_OR()
{
    /*
     * OR A, E
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A |= E;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("OR A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_B4_OR()
{
    /*
     * OR A, H
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A |= H;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("OR A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_B5_OR()
{
    /*
     * OR A, L
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    A |= L;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("OR A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_B6_OR()
{
    /*
     * OR A, [HL]
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    A |= read_8(get_HL());

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("OR A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_B7_OR()
{
    /*
     * OR A, A
     * Flags: Z 0 0 0
     * Cycles: 4
     */
    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("OR A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_B8_CP()
{
    /*
     * CP A, B
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = B;

    set_Z(op1 == op2);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(op1 < op2);
    current_instruction_asm = std::format("CP A, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_B9_CP()
{
    /*
     * CP A, C
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = C;

    set_Z(op1 == op2);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(op1 < op2);
    current_instruction_asm = std::format("CP A, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_BA_CP()
{
    /*
     * CP A, D
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = D;

    set_Z(op1 == op2);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(op1 < op2);
    current_instruction_asm = std::format("CP A, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_BB_CP()
{
    /*
     * CP A, E
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = E;

    set_Z(op1 == op2);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(op1 < op2);
    current_instruction_asm = std::format("CP A, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_BC_CP()
{
    /*
     * CP A, H
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = H;

    set_Z(op1 == op2);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(op1 < op2);
    current_instruction_asm = std::format("CP A, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_BD_CP()
{
    /*
     * CP A, L
     * Flags: Z 1 H C
     * Cycles: 4
     */
    const uint8_t op1 = A;
    const uint8_t op2 = L;

    set_Z(op1 == op2);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(op1 < op2);
    current_instruction_asm = std::format("CP A, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_BE_CP()
{
    /*
     * CP A, [HL]
     * Flags: Z 1 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t op2 = read_8(get_HL());

    set_Z(op1 == op2);
    set_N(1);
    set_H((op1 & 0x0f) < (op2 & 0x0f));
    set_C(op1 < op2);
    current_instruction_asm = std::format("CP A, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_BF_CP()
{
    /*
     * CP A, A
     * Flags: 1 1 0 0
     * Cycles: 4
     */
    set_Z(1);
    set_N(1);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("CP A, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_C0_RET()
{
    /*
     * RET NZ
     * Flags: - - - -
     * Cycles: 20/8
     */
    if (!get_Z())
    {
        pc = pop_16();
        num_cycles_elapsed += 12;
    }

    current_instruction_asm = std::format("RET NZ");
}

template <typename Bus>
void Cpu<Bus>::instruction_C1_POP()
{
    /*
     * POP BC
     * Flags: - - - -
     * Cycles: 12
     */
    set_BC(pop_16());

    current_instruction_asm = std::format("POP BC");
}

template <typename Bus>
void Cpu<Bus>::instruction_C2_JP()
{
    /*
     * JP NZ, a16
     * Flags: - - - -
     * Cycles: 16/12
     */
    const uint16_t a16 = fetch_16();

    if (!get_Z())
    {
        pc = a16;
        num_cycles_elapsed += 4;
    }

    current_instruction_asm = std::format("JP NZ, {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_C3_JP()
{
    /*
     * JP a16
     * Flags: - - - -
     * Cycles: 16
     */
    const uint16_t a16 = fetch_16();
    pc = a16;

    current_instruction_asm = std::format("JP {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_C4_CALL()
{
    /*
     * CALL NZ, a16
     * Flags: - - - -
     * Cycles: 24/12
     */
    const uint16_t a16 = fetch_16();

    if (!get_Z())
    {
        push_16(pc);
        pc = a16;
        num_cycles_elapsed += 12;
    }

    current_instruction_asm = std::format("CALL NZ, {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_C5_PUSH()
{
    /*
     * PUSH BC
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(get_BC());

    current_instruction_asm = std::format("PUSH BC");
}

template <typename Bus>
void Cpu<Bus>::instruction_C6_ADD()
{
    /*
     * ADD A, n8
     * Flags: Z 0 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t n8 = fetch_8();
    const uint16_t result = op1 + n8;

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (n8 & 0x0f) > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADD A, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_C7_RST()
{
    /*
     * RST $00
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(pc);
    pc = 0x0000;

    current_instruction_asm = std::format("RST 00");
}

template <typename Bus>
void Cpu<Bus>::instruction_C8_RET()
{
    /*
     * RET Z
     * Flags: - - - -
     * Cycles: 20/8
     */
    if (get_Z())
    {
        pc = pop_16();
        num_cycles_elapsed += 12;
    }

    current_instruction_asm = std::format("RET Z");
}

template <typename Bus>
void Cpu<Bus>::instruction_C9_RET()
{
    /*
     * RET
     * Flags: - - - -
     * Cycles: 16
     */
    pc = pop_16();

    current_instruction_asm = std::format("RET ");
}

template <typename Bus>
void Cpu<Bus>::instruction_CA_JP()
{
    /*
     * JP Z, a16
     * Flags: - - - -
     * Cycles: 12
     */
    const uint16_t a16 = fetch_16();

    if (get_Z())
    {
        pc = a16;
        num_cycles_elapsed += 4;
    }

    current_instruction_asm = std::format("JP Z, {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_CC_CALL()
{
    /*
     * CALL Z, a16
     * Flags: - - - -
     * Cycles: 24/12
     */
    const uint16_t a16 = fetch_16();

    if (get_Z())
    {
        push_16(pc);
        pc = a16;
        num_cycles_elapsed += 12;
    }

    current_instruction_asm = std::format("CALL Z, {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_CD_CALL()
{
    /*
     * CALL a16
     * Flags: - - - -
     * Cycles: 24
     */
    const uint16_t a16 = fetch_16();
    push_16(pc);
    pc = a16;

    current_instruction_asm = std::format("CALL {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_CE_ADC()
{
    /*
     * ADC A, n8
     * Flags: Z 0 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t n8 = fetch_8();
    const uint16_t result = op1 + n8 + get_C();

    A = result;

    set_Z(result == 0);
    set_N(0);
    set_H((op1 & 0x0f) + (n8 & 0x0f) + get_C() > 0x0f);
    set_C(result & 0x100);
    current_instruction_asm = std::format("ADC A, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_CF_RST()
{
    /*
     * RST $08
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(pc);
    pc = 0x0008;

    current_instruction_asm = std::format("RST 08");
}

template <typename Bus>
void Cpu<Bus>::instruction_D0_RET()
{
    /*
     * RET NC
     * Flags: - - - -
     * Cycles: 20/8
     */
    if (!get_C())
    {
        pc = pop_16();
        num_cycles_elapsed += 12;
    }

    current_instruction_asm = std::format("RET NC");
}

template <typename Bus>
void Cpu<Bus>::instruction_D1_POP()
{
    /*
     * POP DE
     * Flags: - - - -
     * Cycles: 12
     */
    set_DE(pop_16());

    current_instruction_asm = std::format("POP DE");
}

template <typename Bus>
void Cpu<Bus>::instruction_D2_JP()
{
    /*
     * JP NC, a16
     * Flags: - - - -
     * Cycles: 16/12
     */
    const uint16_t a16 = fetch_16();

    if (!get_C())
    {
        pc = a16;
        num_cycles_elapsed += 4;
    }

    current_instruction_asm = std::format("JP NC, {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_D4_CALL()
{
    /*
     * CALL NC, a16
     * Flags: - - - -
     * Cycles: 24/12
     */
    const uint16_t a16 = fetch_16();

    if (!get_C())
    {
        push_16(pc);
        pc = a16;
        num_cycles_elapsed += 12;
    }

    current_instruction_asm = std::format("CALL NC, {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_D5_PUSH()
{
    /*
     * PUSH DE
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(get_DE());

    current_instruction_asm = std::format("PUSH DE");
}

template <typename Bus>
void Cpu<Bus>::instruction_D6_SUB()
{
    /*
     * SUB A, n8
     * Flags: Z 1 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t n8 = fetch_8();
    const uint16_t result = op1 - n8;

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (n8 & 0x0f));
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SUB A, n8");
}

template <typename Bus>
void Cpu<Bus>::instruction_D7_RST()
{
    /*
     * RST $10
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(pc);
    pc = 0x0010;

    current_instruction_asm = std::format("RST 10");
}

template <typename Bus>
void Cpu<Bus>::instruction_D8_RET()
{
    /*
     * RET C
     * Flags: - - - -
     * Cycles: 20/8
     */
    if (get_C())
    {
        pc = pop_16();
        num_cycles_elapsed += 12;
    }

    current_instruction_asm = std::format("RET C");
}

template <typename Bus>
void Cpu<Bus>::instruction_D9_RETI()
{
    /*
     * RETI
     * Flags: - - - -
     * Cycles: 16
     */
    pc = pop_16();
    interrupts_enbled = false;

    current_instruction_asm = std::format("RETI ");
}

template <typename Bus>
void Cpu<Bus>::instruction_DA_JP()
{
    /*
     * JP C, a16
     * Flags: - - - -
     * Cycles: 12
     */
    const uint16_t a16 = fetch_16();

    if (get_C())
    {
        pc = a16;
        num_cycles_elapsed += 4;
    }

    current_instruction_asm = std::format("JP C, {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_DC_CALL()
{
    /*
     * CALL C, a16
     * Flags: - - - -
     * Cycles: 24/12
     */
    const uint16_t a16 = fetch_16();

    if (get_C())
    {
        push_16(pc);
        pc = a16;
        num_cycles_elapsed += 12;
    }

    current_instruction_asm = std::format("CALL C, {:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_DE_SBC()
{
    /*
     * SBC A, n8
     * Flags: Z 1 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t n8 = fetch_8();
    const uint16_t result = op1 - n8 - get_C();

    A = result;

    set_Z(result == 0);
    set_N(1);
    set_H((op1 & 0x0f) < (n8 & 0x0f) + get_C());
    set_C(result & 0x8000);
    current_instruction_asm = std::format("SBC A, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_DF_RST()
{
    /*
     * RST $18
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(pc);
    pc = 0x0018;

    current_instruction_asm = std::format("RST 18");
}

template <typename Bus>
void Cpu<Bus>::instruction_E0_LDH()
{
    /*
     * LDH [a8], A
     * Flags: - - - -
     * Cycles: 12
     */
    const uint8_t a8 = fetch_8();
    write_8(0xff00 | a8, A);

    current_instruction_asm = std::format("LDH !{:02X}, A", a8);
}

template <typename Bus>
void Cpu<Bus>::instruction_E1_POP()
{
    /*
     * POP HL
     * Flags: - - - -
     * Cycles: 12
     */
    set_HL(pop_16());

    current_instruction_asm = std::format("POP HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_E2_LDH()
{
    /*
     * LDH [C], A
     * Flags: - - - -
     * Cycles: 8
     */
    write_8(0xff00 | C, A);

    current_instruction_asm = std::format("LDH !C, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_E5_PUSH()
{
    /*
     * PUSH HL
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(get_HL());

    current_instruction_asm = std::format("PUSH HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_E6_AND()
{
    /*
     * AND A, n8
     * Flags: Z 0 1 0
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    A &= n8;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("AND A, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_E7_RST()
{
    /*
     * RST $20
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(pc);
    pc = 0x0020;

    current_instruction_asm = std::format("RST 20");
}

template <typename Bus>
void Cpu<Bus>::instruction_E8_ADD()
{
    /*
     * ADD SP, e8
     * Flags: 0 0 H C
     * Cycles: 16
     */
    const uint8_t e8 = fetch_8();
    const uint16_t old_sp = sp;

    sp += static_cast<int8_t>(e8);

    set_Z(0);
    set_N(0);
    set_H((old_sp & 0x0f) + (e8 & 0x0f) > 0x0f);
    set_C(old_sp + e8 > 0xff);
    current_instruction_asm = std::format("ADD SP, {:02X}", e8);
}

template <typename Bus>
void Cpu<Bus>::instruction_E9_JP()
{
    /*
     * JP HL
     * Flags: - - - -
     * Cycles: 4
     */
    pc = get_HL();

    current_instruction_asm = std::format("JP HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_EA_LD()
{
    /*
     * LD [a16], A
     * Flags: - - - -
     * Cycles: 16
     */
    const uint16_t a16 = fetch_16();
    write_16(a16, A);

    current_instruction_asm = std::format("LD !{:04X}, A", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_EE_XOR()
{
    /*
     * XOR A, n8
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    A ^= n8;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("XOR A, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_EF_RST()
{
    /*
     * RST $28
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(pc);
    pc = 0x0028;

    current_instruction_asm = std::format("RST 28");
}

template <typename Bus>
void Cpu<Bus>::instruction_F0_LDH()
{
    /*
     * LDH A, [a8]
     * Flags: - - - -
     * Cycles: 12
     */
    const uint8_t a8 = fetch_8();
    A = read_8(0xff00 | a8);

    current_instruction_asm = std::format("LDH A, !{:02X}", a8);
}

template <typename Bus>
void Cpu<Bus>::instruction_F1_POP()
{
    /*
     * POP AF
     * Flags: Z N H C
     * Cycles: 12
     */
    set_AF(pop_16());

    current_instruction_asm = std::format("POP AF");
}

template <typename Bus>
void Cpu<Bus>::instruction_F2_LDH()
{
    /*
     * LDH A, [C]
     * Flags: - - - -
     * Cycles: 8
     */
    A = read_8(0xff00 | C);

    current_instruction_asm = std::format("LDH A, !C");
}

template <typename Bus>
void Cpu<Bus>::instruction_F3_DI()
{
    /*
     * DI
     * Flags: - - - -
     * Cycles: 4
     */
    interrupts_enbled = false;

    current_instruction_asm = std::format("DI ");
}

template <typename Bus>
void Cpu<Bus>::instruction_F5_PUSH()
{
    /*
     * PUSH AF
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(get_AF());

    current_instruction_asm = std::format("PUSH AF");
}

template <typename Bus>
void Cpu<Bus>::instruction_F6_OR()
{
    /*
     * OR A, n8
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    const uint8_t n8 = fetch_8();
    A |= n8;

    set_Z(A == 0);
    set_N(0);
    set_H(1);
    set_C(0);
    current_instruction_asm = std::format("OR A, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_F7_RST()
{
    /*
     * RST $30
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(pc);
    pc = 0x0030;

    current_instruction_asm = std::format("RST 30");
}

template <typename Bus>
void Cpu<Bus>::instruction_F8_LD()
{
    /*
     * LD HL, SP, e8
     * Flags: 0 0 H C
     * Cycles: 12
     */
    const uint8_t e8 = fetch_8();
    const uint16_t old_HL = get_HL();

    set_HL(sp + static_cast<int8_t>(e8));

    set_Z(0);
    set_N(0);
    set_H((old_HL & 0x0f) + (e8 & 0x0f) > 0x0f);
    set_C(old_HL + e8 > 0xff);
    current_instruction_asm = std::format("LD HL, SP, {:02X}", e8);
}

template <typename Bus>
void Cpu<Bus>::instruction_F9_LD()
{
    /*
     * LD SP, HL
     * Flags: - - - -
     * Cycles: 8
     */
    sp = get_HL();

    current_instruction_asm = std::format("LD SP, HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_FA_LD()
{
    /*
     * LD A, [a16]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint16_t a16 = fetch_16();
    A = read_16(a16);

    current_instruction_asm = std::format("LD A, !{:04X}", a16);
}

template <typename Bus>
void Cpu<Bus>::instruction_FB_EI()
{
    /*
     * EI
     * Flags: - - - -
     * Cycles: 4
     */
    interrupts_enbled = true;

    current_instruction_asm = std::format("EI ");
}

template <typename Bus>
void Cpu<Bus>::instruction_FE_CP()
{
    /*
     * CP A, n8
     * Flags: Z 1 H C
     * Cycles: 8
     */
    const uint8_t op1 = A;
    const uint8_t n8 = fetch_8();

    set_Z(op1 == n8);
    set_N(1);
    set_H((op1 & 0x0f) < (n8 & 0x0f));
    set_C(op1 < n8);
    current_instruction_asm = std::format("CP A, {:02X}", n8);
}

template <typename Bus>
void Cpu<Bus>::instruction_FF_RST()
{
    /*
     * RST $38
     * Flags: - - - -
     * Cycles: 16
     */
    push_16(pc);
    pc = 0x0038;

    current_instruction_asm = std::format("RST 38");
}

/*
 * ============================================================================
 * CB-Prefixed Instructions
 * ============================================================================
 */
template <typename Bus>
void Cpu<Bus>::instruction_CB_00_RLC()
{
    /*
     * RLC B
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = B >> 7;
    B = (B << 1) | bit_7;

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLC B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_01_RLC()
{
    /*
     * RLC C
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = C >> 7;
    C = (C << 1) | bit_7;

    set_Z(C == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLC C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_02_RLC()
{
    /*
     * RLC D
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = D >> 7;
    D = (D << 1) | bit_7;

    set_Z(D == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLC D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_03_RLC()
{
    /*
     * RLC E
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = E >> 7;
    E = (E << 1) | bit_7;

    set_Z(E == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLC E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_04_RLC()
{
    /*
     * RLC H
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = H >> 7;
    H = (H << 1) | bit_7;

    set_Z(H == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLC H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_05_RLC()
{
    /*
     * RLC L
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = L >> 7;
    L = (L << 1) | bit_7;

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLC L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_06_RLC()
{
    /*
     * RLC [HL]
     * Flags: Z 0 0 C
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    const bool bit_7 = value >> 7;
    const uint8_t result = (value << 1) | bit_7;
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLC !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_07_RLC()
{
    /*
     * RLC A
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = A >> 7;
    A = (A << 1) | bit_7;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RLC A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_08_RRC()
{
    /*
     * RRC B
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = B & 1;
    B = (B >> 1) | (bit_0 << 7);

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRC B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_09_RRC()
{
    /*
     * RRC C
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = C & 1;
    C = (C >> 1) | (bit_0 << 7);

    set_Z(C == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRC C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_0A_RRC()
{
    /*
     * RRC D
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = D & 1;
    D = (D >> 1) | (bit_0 << 7);

    set_Z(D == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRC D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_0B_RRC()
{
    /*
     * RRC E
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = E & 1;
    E = (E >> 1) | (bit_0 << 7);

    set_Z(E == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRC E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_0C_RRC()
{
    /*
     * RRC H
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = H & 1;
    H = (H >> 1) | (bit_0 << 7);

    set_Z(H == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRC H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_0D_RRC()
{
    /*
     * RRC L
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = L & 1;
    L = (L >> 1) | (bit_0 << 7);

    set_Z(L == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRC L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_0E_RRC()
{
    /*
     * RRC [HL]
     * Flags: Z 0 0 C
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    const bool bit_0 = value & 1;
    const uint8_t result = (value >> 1) | (bit_0 << 7);
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRC !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_0F_RRC()
{
    /*
     * RRC A
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = A & 1;
    A = (A >> 1) | (bit_0 << 7);

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RRC A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_10_RL()
{
    /*
     * RL B
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = B >> 7;
    B = (B << 1) | get_C();

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RL B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_11_RL()
{
    /*
     * RL C
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = C >> 7;
    C = (C << 1) | get_C();

    set_Z(C == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RL C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_12_RL()
{
    /*
     * RL D
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = D >> 7;
    D = (D << 1) | get_C();

    set_Z(D == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RL D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_13_RL()
{
    /*
     * RL E
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = E >> 7;
    E = (E << 1) | get_C();

    set_Z(E == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RL E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_14_RL()
{
    /*
     * RL H
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = H >> 7;
    H = (H << 1) | get_C();

    set_Z(H == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RL H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_15_RL()
{
    /*
     * RL L
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = L >> 7;
    L = (L << 1) | get_C();

    set_Z(L == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RL L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_16_RL()
{
    /*
     * RL [HL]
     * Flags: Z 0 0 C
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    const bool bit_7 = value >> 7;
    const uint8_t result = (value << 1) | get_C();
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RL !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_17_RL()
{
    /*
     * RL A
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = A >> 7;
    A = (A << 1) | get_C();

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("RL A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_18_RR()
{
    /*
     * RR B
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = B & 1;
    B = (get_C() << 7) | (B >> 1);

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RR B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_19_RR()
{
    /*
     * RR C
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = C & 1;
    C = (get_C() << 7) | (C >> 1);

    set_Z(C == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RR C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_1A_RR()
{
    /*
     * RR D
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = D & 1;
    D = (get_C() << 7) | (D >> 1);

    set_Z(D == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RR D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_1B_RR()
{
    /*
     * RR E
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = E & 1;
    E = (get_C() << 7) | (E >> 1);

    set_Z(E == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RR E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_1C_RR()
{
    /*
     * RR H
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = H & 1;
    H = (get_C() << 7) | (H >> 1);

    set_Z(H == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RR H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_1D_RR()
{
    /*
     * RR L
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = L & 1;
    L = (get_C() << 7) | (L >> 1);

    set_Z(L == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RR L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_1E_RR()
{
    /*
     * RR [HL]
     * Flags: Z 0 0 C
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    const bool bit_0 = value & 1;
    const uint8_t result = (get_C() << 7) | (value >> 1);
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RR !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_1F_RR()
{
    /*
     * RR A
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = A & 1;
    A = (get_C() << 7) | (A >> 1);

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("RR A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_20_SLA()
{
    /*
     * SLA B
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = B >> 7;
    B = B << 1;

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("SLA B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_21_SLA()
{
    /*
     * SLA C
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = C >> 7;
    C = C << 1;

    set_Z(C == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("SLA C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_22_SLA()
{
    /*
     * SLA D
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = D >> 7;
    D = D << 1;

    set_Z(D == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("SLA D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_23_SLA()
{
    /*
     * SLA E
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = E >> 7;
    E = E << 1;

    set_Z(E == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("SLA E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_24_SLA()
{
    /*
     * SLA H
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = H >> 7;
    H = H << 1;

    set_Z(H == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("SLA H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_25_SLA()
{
    /*
     * SLA L
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = L >> 7;
    L = L << 1;

    set_Z(L == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("SLA L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_26_SLA()
{
    /*
     * SLA [HL]
     * Flags: Z 0 0 C
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    const bool bit_7 = value >> 7;
    const uint8_t result = value << 1;
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("SLA !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_27_SLA()
{
    /*
     * SLA A
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_7 = A >> 7;
    A = A << 1;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(bit_7);
    current_instruction_asm = std::format("SLA A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_28_SRA()
{
    /*
     * SRA B
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = B & 1;
    B = (B & 0x80) | (B >> 1);

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRA B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_29_SRA()
{
    /*
     * SRA C
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = C & 1;
    C = (C & 0x80) | (C >> 1);

    set_Z(C == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRA C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_2A_SRA()
{
    /*
     * SRA D
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = D & 1;
    D = (D & 0x80) | (D >> 1);

    set_Z(D == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRA D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_2B_SRA()
{
    /*
     * SRA E
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = E & 1;
    E = (E & 0x80) | (E >> 1);

    set_Z(E == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRA E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_2C_SRA()
{
    /*
     * SRA H
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = H & 1;
    H = (H & 0x80) | (H >> 1);

    set_Z(H == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRA H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_2D_SRA()
{
    /*
     * SRA L
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = L & 1;
    L = (L & 0x80) | (L >> 1);

    set_Z(L == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRA L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_2E_SRA()
{
    /*
     * SRA [HL]
     * Flags: Z 0 0 C
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    const bool bit_0 = value & 1;
    const uint8_t result = (value & 0x80) | (value >> 1);
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRA !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_2F_SRA()
{
    /*
     * SRA A
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = A & 1;
    A = (A & 0x80) | (A >> 1);

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRA A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_30_SWAP()
{
    /*
     * SWAP B
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    B = ((B & 0xf0) >> 4) | ((B & 0x0f) << 4);

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SWAP B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_31_SWAP()
{
    /*
     * SWAP C
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    C = ((C & 0xf0) >> 4) | ((C & 0x0f) << 4);

    set_Z(C == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SWAP C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_32_SWAP()
{
    /*
     * SWAP D
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    D = ((D & 0xf0) >> 4) | ((D & 0x0f) << 4);

    set_Z(D == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SWAP D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_33_SWAP()
{
    /*
     * SWAP E
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    E = ((E & 0xf0) >> 4) | ((E & 0x0f) << 4);

    set_Z(E == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SWAP E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_34_SWAP()
{
    /*
     * SWAP H
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    H = ((H & 0xf0) >> 4) | ((H & 0x0f) << 4);

    set_Z(H == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SWAP H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_35_SWAP()
{
    /*
     * SWAP L
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    L = ((L & 0xf0) >> 4) | ((L & 0x0f) << 4);

    set_Z(L == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SWAP L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_36_SWAP()
{
    /*
     * SWAP [HL]
     * Flags: Z 0 0 0
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    const uint8_t result = ((value & 0xf0) >> 4) | ((value & 0x0f) << 4);
    write_8(get_HL(), value);

    set_Z(result == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SWAP !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_37_SWAP()
{
    /*
     * SWAP A
     * Flags: Z 0 0 0
     * Cycles: 8
     */
    A = ((A & 0xf0) >> 4) | ((A & 0x0f) << 4);

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(0);
    current_instruction_asm = std::format("SWAP A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_38_SRL()
{
    /*
     * SRL B
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = B & 1;
    B = B >> 1;

    set_Z(B == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRL B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_39_SRL()
{
    /*
     * SRL C
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = C & 1;
    C = C >> 1;

    set_Z(C == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRL C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_3A_SRL()
{
    /*
     * SRL D
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = D & 1;
    D = D >> 1;

    set_Z(D == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRL D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_3B_SRL()
{
    /*
     * SRL E
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = E & 1;
    E = E >> 1;

    set_Z(E == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRL E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_3C_SRL()
{
    /*
     * SRL H
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = H & 1;
    H = H >> 1;

    set_Z(H == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRL H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_3D_SRL()
{
    /*
     * SRL L
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = L & 1;
    L = L >> 1;

    set_Z(L == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRL L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_3E_SRL()
{
    /*
     * SRL [HL]
     * Flags: Z 0 0 C
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    const bool bit_0 = value & 1;
    const uint8_t result = value >> 1;
    write_8(get_HL(), result);

    set_Z(result == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRL !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_3F_SRL()
{
    /*
     * SRL A
     * Flags: Z 0 0 C
     * Cycles: 8
     */
    const bool bit_0 = A & 1;
    A = A >> 1;

    set_Z(A == 0);
    set_N(0);
    set_H(0);
    set_C(bit_0);
    current_instruction_asm = std::format("SRL A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_40_BIT()
{
    /*
     * BIT 0, B
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((B & (1 << 0)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 0, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_41_BIT()
{
    /*
     * BIT 0, C
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((C & (1 << 0)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 0, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_42_BIT()
{
    /*
     * BIT 0, D
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((D & (1 << 0)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 0, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_43_BIT()
{
    /*
     * BIT 0, E
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((E & (1 << 0)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 0, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_44_BIT()
{
    /*
     * BIT 0, H
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((H & (1 << 0)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 0, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_45_BIT()
{
    /*
     * BIT 0, L
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((L & (1 << 0)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 0, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_46_BIT()
{
    /*
     * BIT 0, [HL]
     * Flags: Z 0 1 -
     * Cycles: 12
     */
    set_Z((read_8(get_HL()) & (1 << 0)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 0, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_47_BIT()
{
    /*
     * BIT 0, A
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((A & (1 << 0)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 0, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_48_BIT()
{
    /*
     * BIT 1, B
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((B & (1 << 1)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 1, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_49_BIT()
{
    /*
     * BIT 1, C
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((C & (1 << 1)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 1, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_4A_BIT()
{
    /*
     * BIT 1, D
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((D & (1 << 1)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 1, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_4B_BIT()
{
    /*
     * BIT 1, E
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((E & (1 << 1)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 1, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_4C_BIT()
{
    /*
     * BIT 1, H
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((H & (1 << 1)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 1, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_4D_BIT()
{
    /*
     * BIT 1, L
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((L & (1 << 1)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 1, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_4E_BIT()
{
    /*
     * BIT 1, [HL]
     * Flags: Z 0 1 -
     * Cycles: 12
     */
    set_Z((read_8(get_HL()) & (1 << 1)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 1, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_4F_BIT()
{
    /*
     * BIT 1, A
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((A & (1 << 1)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 1, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_50_BIT()
{
    /*
     * BIT 2, B
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((B & (1 << 2)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 2, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_51_BIT()
{
    /*
     * BIT 2, C
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((C & (1 << 2)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 2, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_52_BIT()
{
    /*
     * BIT 2, D
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((D & (1 << 2)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 2, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_53_BIT()
{
    /*
     * BIT 2, E
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((E & (1 << 2)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 2, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_54_BIT()
{
    /*
     * BIT 2, H
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((H & (1 << 2)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 2, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_55_BIT()
{
    /*
     * BIT 2, L
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((L & (1 << 2)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 2, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_56_BIT()
{
    /*
     * BIT 2, [HL]
     * Flags: Z 0 1 -
     * Cycles: 12
     */
    set_Z((read_8(get_HL()) & (1 << 2)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 2, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_57_BIT()
{
    /*
     * BIT 2, A
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((A & (1 << 2)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 2, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_58_BIT()
{
    /*
     * BIT 3, B
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((B & (1 << 3)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 3, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_59_BIT()
{
    /*
     * BIT 3, C
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((C & (1 << 3)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 3, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_5A_BIT()
{
    /*
     * BIT 3, D
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((D & (1 << 3)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 3, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_5B_BIT()
{
    /*
     * BIT 3, E
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((E & (1 << 3)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 3, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_5C_BIT()
{
    /*
     * BIT 3, H
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((H & (1 << 3)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 3, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_5D_BIT()
{
    /*
     * BIT 3, L
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((L & (1 << 3)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 3, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_5E_BIT()
{
    /*
     * BIT 3, [HL]
     * Flags: Z 0 1 -
     * Cycles: 12
     */
    set_Z((read_8(get_HL()) & (1 << 3)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 3, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_5F_BIT()
{
    /*
     * BIT 3, A
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((A & (1 << 3)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 3, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_60_BIT()
{
    /*
     * BIT 4, B
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((B & (1 << 4)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 4, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_61_BIT()
{
    /*
     * BIT 4, C
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((C & (1 << 4)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 4, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_62_BIT()
{
    /*
     * BIT 4, D
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((D & (1 << 4)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 4, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_63_BIT()
{
    /*
     * BIT 4, E
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((E & (1 << 4)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 4, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_64_BIT()
{
    /*
     * BIT 4, H
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((H & (1 << 4)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 4, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_65_BIT()
{
    /*
     * BIT 4, L
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((L & (1 << 4)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 4, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_66_BIT()
{
    /*
     * BIT 4, [HL]
     * Flags: Z 0 1 -
     * Cycles: 12
     */
    set_Z((read_8(get_HL()) & (1 << 4)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 4, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_67_BIT()
{
    /*
     * BIT 4, A
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((A & (1 << 4)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 4, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_68_BIT()
{
    /*
     * BIT 5, B
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((B & (1 << 5)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 5, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_69_BIT()
{
    /*
     * BIT 5, C
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((C & (1 << 5)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 5, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_6A_BIT()
{
    /*
     * BIT 5, D
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((D & (1 << 5)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 5, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_6B_BIT()
{
    /*
     * BIT 5, E
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((E & (1 << 5)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 5, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_6C_BIT()
{
    /*
     * BIT 5, H
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((H & (1 << 5)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 5, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_6D_BIT()
{
    /*
     * BIT 5, L
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((L & (1 << 5)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 5, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_6E_BIT()
{
    /*
     * BIT 5, [HL]
     * Flags: Z 0 1 -
     * Cycles: 12
     */
    set_Z((read_8(get_HL()) & (1 << 5)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 5, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_6F_BIT()
{
    /*
     * BIT 5, A
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((A & (1 << 5)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 5, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_70_BIT()
{
    /*
     * BIT 6, B
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((B & (1 << 6)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 6, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_71_BIT()
{
    /*
     * BIT 6, C
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((C & (1 << 6)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 6, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_72_BIT()
{
    /*
     * BIT 6, D
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((D & (1 << 6)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 6, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_73_BIT()
{
    /*
     * BIT 6, E
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((E & (1 << 6)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 6, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_74_BIT()
{
    /*
     * BIT 6, H
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((H & (1 << 6)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 6, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_75_BIT()
{
    /*
     * BIT 6, L
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((L & (1 << 6)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 6, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_76_BIT()
{
    /*
     * BIT 6, [HL]
     * Flags: Z 0 1 -
     * Cycles: 12
     */
    set_Z((read_8(get_HL()) & (1 << 6)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 6, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_77_BIT()
{
    /*
     * BIT 6, A
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((A & (1 << 6)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 6, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_78_BIT()
{
    /*
     * BIT 7, B
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((B & (1 << 7)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 7, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_79_BIT()
{
    /*
     * BIT 7, C
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((C & (1 << 7)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 7, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_7A_BIT()
{
    /*
     * BIT 7, D
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((D & (1 << 7)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 7, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_7B_BIT()
{
    /*
     * BIT 7, E
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((E & (1 << 7)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 7, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_7C_BIT()
{
    /*
     * BIT 7, H
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((H & (1 << 7)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 7, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_7D_BIT()
{
    /*
     * BIT 7, L
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((L & (1 << 7)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 7, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_7E_BIT()
{
    /*
     * BIT 7, [HL]
     * Flags: Z 0 1 -
     * Cycles: 12
     */
    set_Z((read_8(get_HL()) & (1 << 7)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 7, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_7F_BIT()
{
    /*
     * BIT 7, A
     * Flags: Z 0 1 -
     * Cycles: 8
     */
    set_Z((A & (1 << 7)) == 0);
    set_N(0);
    set_H(1);
    current_instruction_asm = std::format("BIT 7, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_80_RES()
{
    /*
     * RES 0, B
     * Flags: - - - -
     * Cycles: 8
     */
    B &= ~(1 << 0);

    current_instruction_asm = std::format("RES 0, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_81_RES()
{
    /*
     * RES 0, C
     * Flags: - - - -
     * Cycles: 8
     */
    C &= ~(1 << 0);

    current_instruction_asm = std::format("RES 0, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_82_RES()
{
    /*
     * RES 0, D
     * Flags: - - - -
     * Cycles: 8
     */
    D &= ~(1 << 0);

    current_instruction_asm = std::format("RES 0, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_83_RES()
{
    /*
     * RES 0, E
     * Flags: - - - -
     * Cycles: 8
     */
    E &= ~(1 << 0);

    current_instruction_asm = std::format("RES 0, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_84_RES()
{
    /*
     * RES 0, H
     * Flags: - - - -
     * Cycles: 8
     */
    H &= ~(1 << 0);

    current_instruction_asm = std::format("RES 0, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_85_RES()
{
    /*
     * RES 0, L
     * Flags: - - - -
     * Cycles: 8
     */
    L &= ~(1 << 0);

    current_instruction_asm = std::format("RES 0, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_86_RES()
{
    /*
     * RES 0, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value & ~(1 << 0));

    current_instruction_asm = std::format("RES 0, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_87_RES()
{
    /*
     * RES 0, A
     * Flags: - - - -
     * Cycles: 8
     */
    A &= ~(1 << 0);

    current_instruction_asm = std::format("RES 0, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_88_RES()
{
    /*
     * RES 1, B
     * Flags: - - - -
     * Cycles: 8
     */
    B &= ~(1 << 1);

    current_instruction_asm = std::format("RES 1, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_89_RES()
{
    /*
     * RES 1, C
     * Flags: - - - -
     * Cycles: 8
     */
    C &= ~(1 << 1);

    current_instruction_asm = std::format("RES 1, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_8A_RES()
{
    /*
     * RES 1, D
     * Flags: - - - -
     * Cycles: 8
     */
    D &= ~(1 << 1);

    current_instruction_asm = std::format("RES 1, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_8B_RES()
{
    /*
     * RES 1, E
     * Flags: - - - -
     * Cycles: 8
     */
    E &= ~(1 << 1);

    current_instruction_asm = std::format("RES 1, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_8C_RES()
{
    /*
     * RES 1, H
     * Flags: - - - -
     * Cycles: 8
     */
    H &= ~(1 << 1);

    current_instruction_asm = std::format("RES 1, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_8D_RES()
{
    /*
     * RES 1, L
     * Flags: - - - -
     * Cycles: 8
     */
    L &= ~(1 << 1);

    current_instruction_asm = std::format("RES 1, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_8E_RES()
{
    /*
     * RES 1, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value & ~(1 << 1));

    current_instruction_asm = std::format("RES 1, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_8F_RES()
{
    /*
     * RES 1, A
     * Flags: - - - -
     * Cycles: 8
     */
    A &= ~(1 << 1);

    current_instruction_asm = std::format("RES 1, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_90_RES()
{
    /*
     * RES 2, B
     * Flags: - - - -
     * Cycles: 8
     */
    B &= ~(1 << 2);

    current_instruction_asm = std::format("RES 2, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_91_RES()
{
    /*
     * RES 2, C
     * Flags: - - - -
     * Cycles: 8
     */
    C &= ~(1 << 2);

    current_instruction_asm = std::format("RES 2, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_92_RES()
{
    /*
     * RES 2, D
     * Flags: - - - -
     * Cycles: 8
     */
    D &= ~(1 << 2);

    current_instruction_asm = std::format("RES 2, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_93_RES()
{
    /*
     * RES 2, E
     * Flags: - - - -
     * Cycles: 8
     */
    E &= ~(1 << 2);

    current_instruction_asm = std::format("RES 2, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_94_RES()
{
    /*
     * RES 2, H
     * Flags: - - - -
     * Cycles: 8
     */
    H &= ~(1 << 2);

    current_instruction_asm = std::format("RES 2, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_95_RES()
{
    /*
     * RES 2, L
     * Flags: - - - -
     * Cycles: 8
     */
    L &= ~(1 << 2);

    current_instruction_asm = std::format("RES 2, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_96_RES()
{
    /*
     * RES 2, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value & ~(1 << 2));

    current_instruction_asm = std::format("RES 2, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_97_RES()
{
    /*
     * RES 2, A
     * Flags: - - - -
     * Cycles: 8
     */
    A &= ~(1 << 2);

    current_instruction_asm = std::format("RES 2, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_98_RES()
{
    /*
     * RES 3, B
     * Flags: - - - -
     * Cycles: 8
     */
    B &= ~(1 << 3);

    current_instruction_asm = std::format("RES 3, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_99_RES()
{
    /*
     * RES 3, C
     * Flags: - - - -
     * Cycles: 8
     */
    C &= ~(1 << 3);

    current_instruction_asm = std::format("RES 3, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_9A_RES()
{
    /*
     * RES 3, D
     * Flags: - - - -
     * Cycles: 8
     */
    D &= ~(1 << 3);

    current_instruction_asm = std::format("RES 3, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_9B_RES()
{
    /*
     * RES 3, E
     * Flags: - - - -
     * Cycles: 8
     */
    E &= ~(1 << 3);

    current_instruction_asm = std::format("RES 3, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_9C_RES()
{
    /*
     * RES 3, H
     * Flags: - - - -
     * Cycles: 8
     */
    H &= ~(1 << 3);

    current_instruction_asm = std::format("RES 3, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_9D_RES()
{
    /*
     * RES 3, L
     * Flags: - - - -
     * Cycles: 8
     */
    L &= ~(1 << 3);

    current_instruction_asm = std::format("RES 3, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_9E_RES()
{
    /*
     * RES 3, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value & ~(1 << 3));

    current_instruction_asm = std::format("RES 3, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_9F_RES()
{
    /*
     * RES 3, A
     * Flags: - - - -
     * Cycles: 8
     */
    A &= ~(1 << 3);

    current_instruction_asm = std::format("RES 3, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A0_RES()
{
    /*
     * RES 4, B
     * Flags: - - - -
     * Cycles: 8
     */
    B &= ~(1 << 4);

    current_instruction_asm = std::format("RES 4, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A1_RES()
{
    /*
     * RES 4, C
     * Flags: - - - -
     * Cycles: 8
     */
    C &= ~(1 << 4);

    current_instruction_asm = std::format("RES 4, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A2_RES()
{
    /*
     * RES 4, D
     * Flags: - - - -
     * Cycles: 8
     */
    D &= ~(1 << 4);

    current_instruction_asm = std::format("RES 4, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A3_RES()
{
    /*
     * RES 4, E
     * Flags: - - - -
     * Cycles: 8
     */
    E &= ~(1 << 4);

    current_instruction_asm = std::format("RES 4, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A4_RES()
{
    /*
     * RES 4, H
     * Flags: - - - -
     * Cycles: 8
     */
    H &= ~(1 << 4);

    current_instruction_asm = std::format("RES 4, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A5_RES()
{
    /*
     * RES 4, L
     * Flags: - - - -
     * Cycles: 8
     */
    L &= ~(1 << 4);

    current_instruction_asm = std::format("RES 4, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A6_RES()
{
    /*
     * RES 4, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value & ~(1 << 4));

    current_instruction_asm = std::format("RES 4, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A7_RES()
{
    /*
     * RES 4, A
     * Flags: - - - -
     * Cycles: 8
     */
    A &= ~(1 << 4);

    current_instruction_asm = std::format("RES 4, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A8_RES()
{
    /*
     * RES 5, B
     * Flags: - - - -
     * Cycles: 8
     */
    B &= ~(1 << 5);

    current_instruction_asm = std::format("RES 5, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_A9_RES()
{
    /*
     * RES 5, C
     * Flags: - - - -
     * Cycles: 8
     */
    C &= ~(1 << 5);

    current_instruction_asm = std::format("RES 5, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_AA_RES()
{
    /*
     * RES 5, D
     * Flags: - - - -
     * Cycles: 8
     */
    D &= ~(1 << 5);

    current_instruction_asm = std::format("RES 5, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_AB_RES()
{
    /*
     * RES 5, E
     * Flags: - - - -
     * Cycles: 8
     */
    E &= ~(1 << 5);

    current_instruction_asm = std::format("RES 5, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_AC_RES()
{
    /*
     * RES 5, H
     * Flags: - - - -
     * Cycles: 8
     */
    H &= ~(1 << 5);

    current_instruction_asm = std::format("RES 5, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_AD_RES()
{
    /*
     * RES 5, L
     * Flags: - - - -
     * Cycles: 8
     */
    L &= ~(1 << 5);

    current_instruction_asm = std::format("RES 5, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_AE_RES()
{
    /*
     * RES 5, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value & ~(1 << 5));

    current_instruction_asm = std::format("RES 5, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_AF_RES()
{
    /*
     * RES 5, A
     * Flags: - - - -
     * Cycles: 8
     */
    A &= ~(1 << 5);

    current_instruction_asm = std::format("RES 5, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B0_RES()
{
    /*
     * RES 6, B
     * Flags: - - - -
     * Cycles: 8
     */
    B &= ~(1 << 6);

    current_instruction_asm = std::format("RES 6, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B1_RES()
{
    /*
     * RES 6, C
     * Flags: - - - -
     * Cycles: 8
     */
    C &= ~(1 << 6);

    current_instruction_asm = std::format("RES 6, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B2_RES()
{
    /*
     * RES 6, D
     * Flags: - - - -
     * Cycles: 8
     */
    D &= ~(1 << 6);

    current_instruction_asm = std::format("RES 6, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B3_RES()
{
    /*
     * RES 6, E
     * Flags: - - - -
     * Cycles: 8
     */
    E &= ~(1 << 6);

    current_instruction_asm = std::format("RES 6, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B4_RES()
{
    /*
     * RES 6, H
     * Flags: - - - -
     * Cycles: 8
     */
    H &= ~(1 << 6);

    current_instruction_asm = std::format("RES 6, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B5_RES()
{
    /*
     * RES 6, L
     * Flags: - - - -
     * Cycles: 8
     */
    L &= ~(1 << 6);

    current_instruction_asm = std::format("RES 6, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B6_RES()
{
    /*
     * RES 6, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value & ~(1 << 6));

    current_instruction_asm = std::format("RES 6, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B7_RES()
{
    /*
     * RES 6, A
     * Flags: - - - -
     * Cycles: 8
     */
    A &= ~(1 << 6);

    current_instruction_asm = std::format("RES 6, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B8_RES()
{
    /*
     * RES 7, B
     * Flags: - - - -
     * Cycles: 8
     */
    B &= ~(1 << 7);

    current_instruction_asm = std::format("RES 7, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_B9_RES()
{
    /*
     * RES 7, C
     * Flags: - - - -
     * Cycles: 8
     */
    C &= ~(1 << 7);

    current_instruction_asm = std::format("RES 7, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_BA_RES()
{
    /*
     * RES 7, D
     * Flags: - - - -
     * Cycles: 8
     */
    D &= ~(1 << 7);

    current_instruction_asm = std::format("RES 7, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_BB_RES()
{
    /*
     * RES 7, E
     * Flags: - - - -
     * Cycles: 8
     */
    E &= ~(1 << 7);

    current_instruction_asm = std::format("RES 7, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_BC_RES()
{
    /*
     * RES 7, H
     * Flags: - - - -
     * Cycles: 8
     */
    H &= ~(1 << 7);

    current_instruction_asm = std::format("RES 7, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_BD_RES()
{
    /*
     * RES 7, L
     * Flags: - - - -
     * Cycles: 8
     */
    L &= ~(1 << 7);

    current_instruction_asm = std::format("RES 7, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_BE_RES()
{
    /*
     * RES 7, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value & ~(1 << 7));

    current_instruction_asm = std::format("RES 7, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_BF_RES()
{
    /*
     * RES 7, A
     * Flags: - - - -
     * Cycles: 8
     */
    A &= ~(1 << 7);

    current_instruction_asm = std::format("RES 7, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C0_SET()
{
    /*
     * SET 0, B
     * Flags: - - - -
     * Cycles: 8
     */
    B |= (1 << 0);

    current_instruction_asm = std::format("SET 0, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C1_SET()
{
    /*
     * SET 0, C
     * Flags: - - - -
     * Cycles: 8
     */
    C |= (1 << 0);

    current_instruction_asm = std::format("SET 0, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C2_SET()
{
    /*
     * SET 0, D
     * Flags: - - - -
     * Cycles: 8
     */
    D |= (1 << 0);

    current_instruction_asm = std::format("SET 0, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C3_SET()
{
    /*
     * SET 0, E
     * Flags: - - - -
     * Cycles: 8
     */
    E |= (1 << 0);

    current_instruction_asm = std::format("SET 0, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C4_SET()
{
    /*
     * SET 0, H
     * Flags: - - - -
     * Cycles: 8
     */
    H |= (1 << 0);

    current_instruction_asm = std::format("SET 0, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C5_SET()
{
    /*
     * SET 0, L
     * Flags: - - - -
     * Cycles: 8
     */
    L |= (1 << 0);

    current_instruction_asm = std::format("SET 0, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C6_SET()
{
    /*
     * SET 0, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value | (1 << 0));

    current_instruction_asm = std::format("SET 0, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C7_SET()
{
    /*
     * SET 0, A
     * Flags: - - - -
     * Cycles: 8
     */
    A |= (1 << 0);

    current_instruction_asm = std::format("SET 0, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C8_SET()
{
    /*
     * SET 1, B
     * Flags: - - - -
     * Cycles: 8
     */
    B |= (1 << 1);

    current_instruction_asm = std::format("SET 1, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_C9_SET()
{
    /*
     * SET 1, C
     * Flags: - - - -
     * Cycles: 8
     */
    C |= (1 << 1);

    current_instruction_asm = std::format("SET 1, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_CA_SET()
{
    /*
     * SET 1, D
     * Flags: - - - -
     * Cycles: 8
     */
    D |= (1 << 1);

    current_instruction_asm = std::format("SET 1, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_CB_SET()
{
    /*
     * SET 1, E
     * Flags: - - - -
     * Cycles: 8
     */
    E |= (1 << 1);

    current_instruction_asm = std::format("SET 1, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_CC_SET()
{
    /*
     * SET 1, H
     * Flags: - - - -
     * Cycles: 8
     */
    H |= (1 << 1);

    current_instruction_asm = std::format("SET 1, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_CD_SET()
{
    /*
     * SET 1, L
     * Flags: - - - -
     * Cycles: 8
     */
    L |= (1 << 1);

    current_instruction_asm = std::format("SET 1, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_CE_SET()
{
    /*
     * SET 1, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value | (1 << 1));

    current_instruction_asm = std::format("SET 1, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_CF_SET()
{
    /*
     * SET 1, A
     * Flags: - - - -
     * Cycles: 8
     */
    A |= (1 << 1);

    current_instruction_asm = std::format("SET 1, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D0_SET()
{
    /*
     * SET 2, B
     * Flags: - - - -
     * Cycles: 8
     */
    B |= (1 << 2);

    current_instruction_asm = std::format("SET 2, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D1_SET()
{
    /*
     * SET 2, C
     * Flags: - - - -
     * Cycles: 8
     */
    C |= (1 << 2);

    current_instruction_asm = std::format("SET 2, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D2_SET()
{
    /*
     * SET 2, D
     * Flags: - - - -
     * Cycles: 8
     */
    D |= (1 << 2);

    current_instruction_asm = std::format("SET 2, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D3_SET()
{
    /*
     * SET 2, E
     * Flags: - - - -
     * Cycles: 8
     */
    E |= (1 << 2);

    current_instruction_asm = std::format("SET 2, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D4_SET()
{
    /*
     * SET 2, H
     * Flags: - - - -
     * Cycles: 8
     */
    H |= (1 << 2);

    current_instruction_asm = std::format("SET 2, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D5_SET()
{
    /*
     * SET 2, L
     * Flags: - - - -
     * Cycles: 8
     */
    L |= (1 << 2);

    current_instruction_asm = std::format("SET 2, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D6_SET()
{
    /*
     * SET 2, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value | (1 << 2));

    current_instruction_asm = std::format("SET 2, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D7_SET()
{
    /*
     * SET 2, A
     * Flags: - - - -
     * Cycles: 8
     */
    A |= (1 << 2);

    current_instruction_asm = std::format("SET 2, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D8_SET()
{
    /*
     * SET 3, B
     * Flags: - - - -
     * Cycles: 8
     */
    B |= (1 << 3);

    current_instruction_asm = std::format("SET 3, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_D9_SET()
{
    /*
     * SET 3, C
     * Flags: - - - -
     * Cycles: 8
     */
    C |= (1 << 3);

    current_instruction_asm = std::format("SET 3, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_DA_SET()
{
    /*
     * SET 3, D
     * Flags: - - - -
     * Cycles: 8
     */
    D |= (1 << 3);

    current_instruction_asm = std::format("SET 3, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_DB_SET()
{
    /*
     * SET 3, E
     * Flags: - - - -
     * Cycles: 8
     */
    E |= (1 << 3);

    current_instruction_asm = std::format("SET 3, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_DC_SET()
{
    /*
     * SET 3, H
     * Flags: - - - -
     * Cycles: 8
     */
    H |= (1 << 3);

    current_instruction_asm = std::format("SET 3, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_DD_SET()
{
    /*
     * SET 3, L
     * Flags: - - - -
     * Cycles: 8
     */
    L |= (1 << 3);

    current_instruction_asm = std::format("SET 3, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_DE_SET()
{
    /*
     * SET 3, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value | (1 << 3));

    current_instruction_asm = std::format("SET 3, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_DF_SET()
{
    /*
     * SET 3, A
     * Flags: - - - -
     * Cycles: 8
     */
    A |= (1 << 3);

    current_instruction_asm = std::format("SET 3, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E0_SET()
{
    /*
     * SET 4, B
     * Flags: - - - -
     * Cycles: 8
     */
    B |= (1 << 4);

    current_instruction_asm = std::format("SET 4, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E1_SET()
{
    /*
     * SET 4, C
     * Flags: - - - -
     * Cycles: 8
     */
    C |= (1 << 4);

    current_instruction_asm = std::format("SET 4, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E2_SET()
{
    /*
     * SET 4, D
     * Flags: - - - -
     * Cycles: 8
     */
    D |= (1 << 4);

    current_instruction_asm = std::format("SET 4, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E3_SET()
{
    /*
     * SET 4, E
     * Flags: - - - -
     * Cycles: 8
     */
    E |= (1 << 4);

    current_instruction_asm = std::format("SET 4, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E4_SET()
{
    /*
     * SET 4, H
     * Flags: - - - -
     * Cycles: 8
     */
    H |= (1 << 4);

    current_instruction_asm = std::format("SET 4, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E5_SET()
{
    /*
     * SET 4, L
     * Flags: - - - -
     * Cycles: 8
     */
    L |= (1 << 4);

    current_instruction_asm = std::format("SET 4, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E6_SET()
{
    /*
     * SET 4, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value | (1 << 4));

    current_instruction_asm = std::format("SET 4, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E7_SET()
{
    /*
     * SET 4, A
     * Flags: - - - -
     * Cycles: 8
     */
    A |= (1 << 4);

    current_instruction_asm = std::format("SET 4, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E8_SET()
{
    /*
     * SET 5, B
     * Flags: - - - -
     * Cycles: 8
     */
    B |= (1 << 5);

    current_instruction_asm = std::format("SET 5, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_E9_SET()
{
    /*
     * SET 5, C
     * Flags: - - - -
     * Cycles: 8
     */
    C |= (1 << 5);

    current_instruction_asm = std::format("SET 5, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_EA_SET()
{
    /*
     * SET 5, D
     * Flags: - - - -
     * Cycles: 8
     */
    D |= (1 << 5);

    current_instruction_asm = std::format("SET 5, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_EB_SET()
{
    /*
     * SET 5, E
     * Flags: - - - -
     * Cycles: 8
     */
    E |= (1 << 5);

    current_instruction_asm = std::format("SET 5, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_EC_SET()
{
    /*
     * SET 5, H
     * Flags: - - - -
     * Cycles: 8
     */
    H |= (1 << 5);

    current_instruction_asm = std::format("SET 5, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_ED_SET()
{
    /*
     * SET 5, L
     * Flags: - - - -
     * Cycles: 8
     */
    L |= (1 << 5);

    current_instruction_asm = std::format("SET 5, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_EE_SET()
{
    /*
     * SET 5, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value | (1 << 5));

    current_instruction_asm = std::format("SET 5, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_EF_SET()
{
    /*
     * SET 5, A
     * Flags: - - - -
     * Cycles: 8
     */
    A |= (1 << 5);

    current_instruction_asm = std::format("SET 5, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F0_SET()
{
    /*
     * SET 6, B
     * Flags: - - - -
     * Cycles: 8
     */
    B |= (1 << 6);

    current_instruction_asm = std::format("SET 6, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F1_SET()
{
    /*
     * SET 6, C
     * Flags: - - - -
     * Cycles: 8
     */
    C |= (1 << 6);

    current_instruction_asm = std::format("SET 6, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F2_SET()
{
    /*
     * SET 6, D
     * Flags: - - - -
     * Cycles: 8
     */
    D |= (1 << 6);

    current_instruction_asm = std::format("SET 6, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F3_SET()
{
    /*
     * SET 6, E
     * Flags: - - - -
     * Cycles: 8
     */
    E |= (1 << 6);

    current_instruction_asm = std::format("SET 6, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F4_SET()
{
    /*
     * SET 6, H
     * Flags: - - - -
     * Cycles: 8
     */
    H |= (1 << 6);

    current_instruction_asm = std::format("SET 6, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F5_SET()
{
    /*
     * SET 6, L
     * Flags: - - - -
     * Cycles: 8
     */
    L |= (1 << 6);

    current_instruction_asm = std::format("SET 6, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F6_SET()
{
    /*
     * SET 6, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value | (1 << 6));

    current_instruction_asm = std::format("SET 6, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F7_SET()
{
    /*
     * SET 6, A
     * Flags: - - - -
     * Cycles: 8
     */
    A |= (1 << 6);

    current_instruction_asm = std::format("SET 6, A");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F8_SET()
{
    /*
     * SET 7, B
     * Flags: - - - -
     * Cycles: 8
     */
    B |= (1 << 7);

    current_instruction_asm = std::format("SET 7, B");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_F9_SET()
{
    /*
     * SET 7, C
     * Flags: - - - -
     * Cycles: 8
     */
    C |= (1 << 7);

    current_instruction_asm = std::format("SET 7, C");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_FA_SET()
{
    /*
     * SET 7, D
     * Flags: - - - -
     * Cycles: 8
     */
    D |= (1 << 7);

    current_instruction_asm = std::format("SET 7, D");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_FB_SET()
{
    /*
     * SET 7, E
     * Flags: - - - -
     * Cycles: 8
     */
    E |= (1 << 7);

    current_instruction_asm = std::format("SET 7, E");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_FC_SET()
{
    /*
     * SET 7, H
     * Flags: - - - -
     * Cycles: 8
     */
    H |= (1 << 7);

    current_instruction_asm = std::format("SET 7, H");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_FD_SET()
{
    /*
     * SET 7, L
     * Flags: - - - -
     * Cycles: 8
     */
    L |= (1 << 7);

    current_instruction_asm = std::format("SET 7, L");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_FE_SET()
{
    /*
     * SET 7, [HL]
     * Flags: - - - -
     * Cycles: 16
     */
    const uint8_t value = read_8(get_HL());
    write_8(get_HL(), value | (1 << 7));

    current_instruction_asm = std::format("SET 7, !HL");
}

template <typename Bus>
void Cpu<Bus>::instruction_CB_FF_SET()
{
    /*
     * SET 7, A
     * Flags: - - - -
     * Cycles: 8
     */
    A |= (1 << 7);

    current_instruction_asm = std::format("SET 7, A");
}

} // namespace Gbpp::Backend